# 1. Calendar
df_cal = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Calendar')

# 2. Customers
df_cus = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Customers')

# 3. Product Categories
df_prod_cat = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Product_Categories')

# 4. Product Subcategories
df_prod_sub_cat = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Product_Subcategories')

# 5. products
df_products = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Products')


#6. Product Returns
df_prod_returns = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Returns')

# 7. Sales 2017
df_sales_15 = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Sales_2015')


# 8. Sales 2016
df_sales_16 = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Sales_2016')

# 9. Sales 2017
df_sales_17 = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Sales_2017')


#10. Territories
df_terr = spark.read.format('csv')\
    .option('header', 'true')\
    .option('inferSchema', 'true')\
    .load('abfss://bronze@eclasessgen2.dfs.core.windows.net/AdventureWorks_Territories')

=================================================================
Creating View Script

========================================================================================
Polybase script to connect ADLS to Synapse analytics

 --Step 1- Create master key encryption
 CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'Admin@123';


--Step 2- Create database scope credential
 CREATE DATABASE SCOPED CREDENTIAL cred_gaurav
 with IDENTITY = 'Managed Identity';

 --Step 3- Creating external data source for silver layer
 CREATE EXTERNAL DATA SOURCE source_silver
 WITH(
    LOCATION = 'https://eclasessgen2.blob.core.windows.net/silver',
    CREDENTIAL = cred_gaurav
 )

--Step 4- Create external data source for gold layer

 CREATE EXTERNAL DATA SOURCE source_gold
 WITH(
    LOCATION = 'https://eclasessgen2.blob.core.windows.net/gold',
    CREDENTIAL = cred_gaurav
 )

 --Step 5- Create external file format
 CREATE EXTERNAL FILE FORMAT format_parquet
 WITH
 (
    FORMAT_TYPE = PARQUET,
    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.SnappyCodec'
 )
===========================================================================================




